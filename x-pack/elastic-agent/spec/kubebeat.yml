name: Kubebeat
cmd: kubebeat
args: ["-e", "-d", "*"]
restart_on_output_change: true
artifact: beats/kubebeat
action_input_types:
- kubebeat

rules:
- fix_stream: {}
- inject_index:
    type: logs

- inject_stream_processor:
    on_conflict: insert_after
    type: logs

- filter_values:
    selector: inputs
    key: type
    values:
    - kubebeat

- inject_agent_info: {}

- filter:
    selectors:
    - inputs
    - output

when: length(${inputs}) > 0 and hasKey(${output}, 'elasticsearch', 'logstash')

# TODO kubebeat needs to be filled up relevant Needs to  be filled according to kubebeat config